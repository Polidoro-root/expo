{"version":3,"file":"create-primitive.js","sourceRoot":"","sources":["../src/create-primitive.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  Appearance,\n  AccessibilityInfo,\n  AccessibilityChangeEventName,\n  StyleSheet,\n  ViewStyle,\n  ImageStyle,\n  TextStyle,\n  Dimensions,\n} from 'react-native';\n\nimport { ThemePreference, ThemePreferences } from './ThemeProvider';\n\ntype StyleType = ViewStyle | TextStyle | ImageStyle;\n\ntype Options = {\n  base?: StyleType;\n  variants?: VariantMap<StyleType>;\n};\n\ntype VariantMap<T> = { [key: string]: { [key: string]: T } };\n\ntype Nested<Type> = {\n  [Property in keyof Type]?: keyof Type[Property];\n};\n\ntype SelectorMap<Variants> = Partial<{\n  [K in keyof Variants]?: {\n    [T in keyof Variants[K]]?: StyleType;\n  };\n}>;\n\ntype Selectors<Variants> = {\n  light?: SelectorMap<Variants>;\n  dark?: SelectorMap<Variants>;\n  boldText?: SelectorMap<Variants>;\n  grayScale?: SelectorMap<Variants>;\n  invertColors?: SelectorMap<Variants>;\n  reduceTransparency?: SelectorMap<Variants>;\n  screenReader?: SelectorMap<Variants>;\n  width?: { [key: string]: SelectorMap<Variants> };\n  height?: { [key: string]: SelectorMap<Variants> };\n};\n\nconst selectorStore = createSelectorStore();\n\nexport function create<T, O extends Options>(\n  component: React.ComponentType<T>,\n  config: O & { selectors?: Selectors<O['variants']>; props?: T }\n) {\n  const styleFn = getStylesFn(config);\n  config.selectors = config.selectors || {};\n\n  const Component = React.forwardRef<\n    T,\n    React.PropsWithChildren<T> & Nested<typeof config['variants']>\n  >((props, ref) => {\n    const style = styleFn(props);\n    const selectorStyle = useSelectors(config.selectors, props);\n\n    return React.createElement(component, {\n      ...props,\n      ...config.props,\n      style: StyleSheet.flatten([\n        style,\n        // @ts-ignore\n        props.style || {},\n        selectorStyle,\n      ]),\n      ref,\n    });\n  });\n\n  return Component;\n}\n\nexport function getStylesFn(options: Options) {\n  let styles: any = options.base || {};\n\n  function handleVariantProps(props: any) {\n    options.variants = options.variants || {};\n    styles = options.base;\n\n    for (const key in props) {\n      if (options.variants[key]) {\n        const value = props[key];\n\n        const styleValue = options.variants[key][value];\n        if (styleValue) {\n          styles = StyleSheet.flatten(StyleSheet.compose(styles, styleValue));\n        }\n      }\n    }\n\n    return styles;\n  }\n\n  return handleVariantProps;\n}\n\ntype SelectorStoreListener = (updatedKeys: string[], state: any) => void;\n\nfunction createSelectorStore() {\n  const activeSelectorMap: Record<string, boolean> = {};\n  const dimensionMap: Record<string, number> = {};\n\n  let listeners: SelectorStoreListener[] = [];\n\n  const currentPreference = ThemePreferences.getPreference();\n\n  let currentColorScheme = Appearance.getColorScheme();\n\n  if (currentPreference !== 'no-preference') {\n    currentColorScheme = currentPreference;\n  }\n\n  if (currentColorScheme != null) {\n    if (currentColorScheme === 'light') {\n      activeSelectorMap['light'] = true;\n      activeSelectorMap['dark'] = false;\n    } else if (currentColorScheme === 'dark') {\n      activeSelectorMap['light'] = false;\n      activeSelectorMap['dark'] = true;\n    }\n\n    notify(['light', 'dark']);\n  }\n\n  Appearance.addChangeListener(({ colorScheme }) => {\n    const currentPreference = ThemePreferences.getPreference();\n\n    if (currentPreference === 'no-preference') {\n      if (colorScheme === 'light') {\n        activeSelectorMap['light'] = true;\n        activeSelectorMap['dark'] = false;\n      } else if (colorScheme === 'dark') {\n        activeSelectorMap['light'] = false;\n        activeSelectorMap['dark'] = true;\n      } else {\n        delete activeSelectorMap['light'];\n        delete activeSelectorMap['dark'];\n      }\n\n      notify(['light', 'dark']);\n    }\n  });\n\n  ThemePreferences.addChangeListener((currentPreference: ThemePreference) => {\n    if (currentPreference === 'light') {\n      activeSelectorMap['light'] = true;\n      activeSelectorMap['dark'] = false;\n    } else if (currentPreference === 'dark') {\n      activeSelectorMap['light'] = false;\n      activeSelectorMap['dark'] = true;\n    } else {\n      const currentColorScheme = Appearance.getColorScheme();\n\n      if (currentColorScheme != null) {\n        if (currentColorScheme === 'light') {\n          activeSelectorMap['light'] = true;\n          activeSelectorMap['dark'] = false;\n        } else if (currentColorScheme === 'dark') {\n          activeSelectorMap['light'] = false;\n          activeSelectorMap['dark'] = true;\n        } else {\n          delete activeSelectorMap['light'];\n          delete activeSelectorMap['dark'];\n        }\n      }\n    }\n\n    notify(['light', 'dark']);\n  });\n\n  const a11yTraits: AccessibilityChangeEventName[] = [\n    'boldTextChanged',\n    'grayscaleChanged',\n    'invertColorsChanged',\n    'reduceMotionChanged',\n    'reduceTransparencyChanged',\n    'screenReaderChanged',\n  ];\n\n  a11yTraits.forEach((trait) => {\n    AccessibilityInfo.addEventListener(trait, (isActive) => {\n      activeSelectorMap[trait] = isActive;\n      notify([trait]);\n    });\n  });\n\n  async function getInitialValues() {\n    const [\n      isBoldTextEnabled,\n      isGrayscaleEnabled,\n      isInvertColorsEnabled,\n      isReduceMotionEnabled,\n      isReduceTransparencyEnabled,\n      isScreenReaderEnabled,\n    ] = await Promise.all([\n      AccessibilityInfo.isBoldTextEnabled(),\n      AccessibilityInfo.isGrayscaleEnabled(),\n      AccessibilityInfo.isInvertColorsEnabled(),\n      AccessibilityInfo.isReduceMotionEnabled(),\n      AccessibilityInfo.isReduceTransparencyEnabled(),\n      AccessibilityInfo.isScreenReaderEnabled(),\n    ]);\n\n    activeSelectorMap['boldText'] = isBoldTextEnabled;\n    activeSelectorMap['grayScale'] = isGrayscaleEnabled;\n    activeSelectorMap['invertColors'] = isInvertColorsEnabled;\n    activeSelectorMap['reduceMotion'] = isReduceMotionEnabled;\n    activeSelectorMap['reduceTransparency'] = isReduceTransparencyEnabled;\n    activeSelectorMap['screenReader'] = isScreenReaderEnabled;\n\n    notify(a11yTraits);\n  }\n\n  getInitialValues();\n\n  const { width: initialWidth, height: initialHeight } = Dimensions.get('screen');\n\n  dimensionMap['width'] = initialWidth;\n  dimensionMap['height'] = initialHeight;\n\n  Dimensions.addEventListener('change', ({ screen }) => {\n    dimensionMap['width'] = screen.width;\n    dimensionMap['height'] = screen.height;\n\n    notify(['width', 'height']);\n  });\n\n  function subscribe(fn: SelectorStoreListener) {\n    listeners.push(fn);\n\n    notify([]);\n\n    return () => {\n      listeners = listeners.filter((l) => l !== fn);\n    };\n  }\n\n  function getState() {\n    return {\n      ...activeSelectorMap,\n      ...dimensionMap,\n    };\n  }\n\n  function notify(keys: string[]) {\n    const state = getState();\n    listeners.forEach((listener) => listener(keys, state));\n  }\n\n  return {\n    subscribe,\n  };\n}\n\nfunction useSelectors(selectors: any, props: any) {\n  const isMounted = React.useRef(false);\n\n  React.useEffect(() => {\n    isMounted.current = true;\n\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n\n  const [activeVariants, setActiveVariants] = React.useState<any>({});\n\n  React.useEffect(() => {\n    const unsubscribe = selectorStore.subscribe((keys, state) => {\n      const variants: any = {};\n\n      Object.entries(state).forEach(([selectorKey, selectorValue]: any) => {\n        if (selectorValue !== false) {\n          if (selectorKey === 'width' || selectorKey === 'height') {\n            const queries = selectors[selectorKey];\n            for (const mediaQuery in queries) {\n              const expression = `${selectorValue} ${mediaQuery}`;\n              try {\n                // eslint-disable-next-line\n                if (eval(expression)) {\n                  mergeDeep(variants, queries[mediaQuery]);\n                }\n              } catch {\n                console.warn(\n                  `Did not pass in a valid query selector '${expression}' -> try a key with a valid expression like '> {number}'`\n                );\n              }\n            }\n          } else {\n            mergeDeep(variants, selectors[selectorKey]);\n          }\n        }\n      });\n\n      if (isMounted.current) {\n        setActiveVariants(variants);\n      }\n    });\n\n    return () => unsubscribe();\n  }, [selectors]);\n\n  const activeStyles = {};\n\n  if (activeVariants['base']) {\n    mergeDeep(activeStyles, activeVariants['base']);\n  }\n\n  Object.entries(props).forEach(([variantKey, variantValue]: any) => {\n    if (activeVariants[variantKey] && activeVariants[variantKey][variantValue]) {\n      mergeDeep(activeStyles, activeVariants[variantKey][variantValue]);\n    }\n  });\n\n  return activeStyles;\n}\n\nfunction mergeDeep(target: any, source: any) {\n  const isObject = (obj: any) => obj && typeof obj === 'object';\n\n  if (!isObject(target) || !isObject(source)) {\n    return source;\n  }\n\n  Object.keys(source).forEach((key) => {\n    const targetValue = target[key];\n    const sourceValue = source[key];\n\n    if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\n      target[key] = targetValue.concat(sourceValue);\n    } else if (isObject(targetValue) && isObject(sourceValue)) {\n      target[key] = mergeDeep(Object.assign({}, targetValue), sourceValue);\n    } else {\n      target[key] = sourceValue;\n    }\n  });\n\n  return target;\n}\n"]}